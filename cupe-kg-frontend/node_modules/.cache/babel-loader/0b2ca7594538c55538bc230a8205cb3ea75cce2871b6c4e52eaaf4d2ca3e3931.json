{"ast":null,"code":"import React,{useState,useEffect}from'react';import{MapContainer,TileLayer,useMap}from'react-leaflet';import'leaflet/dist/leaflet.css';import LocationMarker from'../LocationMarker/LocationMarker';import InfoPanel from'../InfoPanel/InfoPanel';import RouteVisualizer from'../RouteVisualizer/RouteVisualizer';import{useMapContext,MapProvider}from'../../context/MapContext';import'./Map.css';// Set India's coordinates and default zoom level\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const INDIA_CENTER=[20.5937,78.9629];const DEFAULT_ZOOM=5;// AnimatedPane handles smooth transitions when changing map view\nconst AnimatedPane=()=>{const map=useMap();const{selectedLocation,mapInstance,setMapInstance}=useMapContext();useEffect(()=>{// Store map instance in context\nif(map&&!mapInstance){setMapInstance(map);}},[map,mapInstance,setMapInstance]);useEffect(()=>{if(selectedLocation){map.flyTo([selectedLocation.coordinates.lat,selectedLocation.coordinates.lng],10,{animate:true,duration:1.5});}},[selectedLocation,map]);return null;};const MapContent=()=>{const{locations,selectedLocation,locationData,isLoading,selectLocation,selectedRoute,selectRoute,clearSelections,resetMapView}=useMapContext();const[isPanelOpen,setIsPanelOpen]=useState(false);useEffect(()=>{setIsPanelOpen(!!locationData);},[locationData]);const handleLocationClick=location=>{selectLocation(location);// Cultural Intelligence can be opened manually via the button in InfoPanel or Header\n};const closePanel=()=>{setIsPanelOpen(false);// Add a slight delay before resetting data\nsetTimeout(()=>{clearSelections();},300);};return/*#__PURE__*/_jsxs(\"div\",{className:\"map-container\",children:[/*#__PURE__*/_jsxs(MapContainer,{center:INDIA_CENTER,zoom:DEFAULT_ZOOM,className:\"map\",children:[/*#__PURE__*/_jsx(TileLayer,{url:\"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\",attribution:\"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors \\xA9 <a href=\\\"https://carto.com/attributions\\\">CARTO</a>\"}),locations.map(location=>/*#__PURE__*/_jsx(LocationMarker,{location:location,isSelected:(selectedLocation===null||selectedLocation===void 0?void 0:selectedLocation.id)===location.id,onClick:()=>handleLocationClick(location)},location.id)),selectedRoute&&/*#__PURE__*/_jsx(RouteVisualizer,{route:selectedRoute}),/*#__PURE__*/_jsx(AnimatedPane,{})]}),/*#__PURE__*/_jsx(\"div\",{className:\"map-controls\",children:/*#__PURE__*/_jsx(\"button\",{className:\"control-btn home-btn\",onClick:resetMapView,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",width:\"18\",height:\"18\",children:/*#__PURE__*/_jsx(\"path\",{fill:\"currentColor\",d:\"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z\"})})})}),/*#__PURE__*/_jsx(InfoPanel,{isOpen:isPanelOpen,isLoading:isLoading,locationData:locationData,selectedLocation:selectedLocation,onClose:closePanel})]});};// In your Map.jsx file, find the Map component at the bottom and replace it with this:\nconst Map=()=>{// Remove the MapProvider wrapper - use the existing context from App.js\nreturn/*#__PURE__*/_jsx(MapContent,{});};export default Map;","map":{"version":3,"names":["React","useState","useEffect","MapContainer","TileLayer","useMap","LocationMarker","InfoPanel","RouteVisualizer","useMapContext","MapProvider","jsx","_jsx","jsxs","_jsxs","INDIA_CENTER","DEFAULT_ZOOM","AnimatedPane","map","selectedLocation","mapInstance","setMapInstance","flyTo","coordinates","lat","lng","animate","duration","MapContent","locations","locationData","isLoading","selectLocation","selectedRoute","selectRoute","clearSelections","resetMapView","isPanelOpen","setIsPanelOpen","handleLocationClick","location","closePanel","setTimeout","className","children","center","zoom","url","attribution","isSelected","id","onClick","route","viewBox","width","height","fill","d","isOpen","onClose","Map"],"sources":["D:/MY projects/CupeKG/cupe-kg-frontend/src/components/Map/Map.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { MapContainer, TileLayer, useMap } from 'react-leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport LocationMarker from '../LocationMarker/LocationMarker';\r\nimport InfoPanel from '../InfoPanel/InfoPanel';\r\nimport RouteVisualizer from '../RouteVisualizer/RouteVisualizer';\r\nimport { useMapContext, MapProvider } from '../../context/MapContext';\r\nimport './Map.css';\r\n\r\n// Set India's coordinates and default zoom level\r\nconst INDIA_CENTER = [20.5937, 78.9629];\r\nconst DEFAULT_ZOOM = 5;\r\n\r\n// AnimatedPane handles smooth transitions when changing map view\r\nconst AnimatedPane = () => {\r\n  const map = useMap();\r\n  const { selectedLocation, mapInstance, setMapInstance } = useMapContext();\r\n  \r\n  useEffect(() => {\r\n    // Store map instance in context\r\n    if (map && !mapInstance) {\r\n      setMapInstance(map);\r\n    }\r\n  }, [map, mapInstance, setMapInstance]);\r\n  \r\n  useEffect(() => {\r\n    if (selectedLocation) {\r\n      map.flyTo(\r\n        [selectedLocation.coordinates.lat, selectedLocation.coordinates.lng], \r\n        10, \r\n        { \r\n          animate: true, \r\n          duration: 1.5 \r\n        }\r\n      );\r\n    }\r\n  }, [selectedLocation, map]);\r\n\r\n  return null;\r\n};\r\n\r\nconst MapContent = () => {\r\n  const { \r\n    locations, \r\n    selectedLocation, \r\n    locationData, \r\n    isLoading, \r\n    selectLocation, \r\n    selectedRoute,\r\n    selectRoute,\r\n    clearSelections,\r\n    resetMapView\r\n  } = useMapContext();\r\n  \r\n  const [isPanelOpen, setIsPanelOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setIsPanelOpen(!!locationData);\r\n  }, [locationData]);\r\n\r\n  const handleLocationClick = (location) => {\r\n    selectLocation(location);\r\n    // Cultural Intelligence can be opened manually via the button in InfoPanel or Header\r\n  };\r\n\r\n\r\n  const closePanel = () => {\r\n    setIsPanelOpen(false);\r\n    // Add a slight delay before resetting data\r\n    setTimeout(() => {\r\n      clearSelections();\r\n    }, 300);\r\n  };\r\n\r\n  return (\r\n    <div className=\"map-container\">\r\n      <MapContainer\r\n        center={INDIA_CENTER}\r\n        zoom={DEFAULT_ZOOM}\r\n        className=\"map\"\r\n      >\r\n        <TileLayer\r\n          url=\"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\"\r\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors &copy; <a href=\"https://carto.com/attributions\">CARTO</a>'\r\n        />\r\n        \r\n        {locations.map(location => (\r\n          <LocationMarker\r\n            key={location.id}\r\n            location={location}\r\n            isSelected={selectedLocation?.id === location.id}\r\n            onClick={() => handleLocationClick(location)}\r\n          />\r\n        ))}\r\n        \r\n        {selectedRoute && <RouteVisualizer route={selectedRoute} />}\r\n        <AnimatedPane />\r\n      </MapContainer>\r\n\r\n      <div className=\"map-controls\">\r\n        <button className=\"control-btn home-btn\" onClick={resetMapView}>\r\n          <svg viewBox=\"0 0 24 24\" width=\"18\" height=\"18\">\r\n            <path fill=\"currentColor\" d=\"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z\"/>\r\n          </svg>\r\n        </button>\r\n      </div>\r\n\r\n      <InfoPanel \r\n        isOpen={isPanelOpen}\r\n        isLoading={isLoading}\r\n        locationData={locationData}\r\n        selectedLocation={selectedLocation}\r\n        onClose={closePanel}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\n// In your Map.jsx file, find the Map component at the bottom and replace it with this:\r\n\r\nconst Map = () => {\r\n  // Remove the MapProvider wrapper - use the existing context from App.js\r\n  return <MapContent />;\r\n};\r\n\r\nexport default Map;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}