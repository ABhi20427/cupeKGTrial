{"ast":null,"code":"// cupe-kg-frontend/src/components/Timeline/Timeline.jsx\n// FINAL VERSION with Complete API Integration\nimport React,{useState,useEffect,useCallback}from'react';import{useTranslation}from'react-i18next';import{useMapContext}from'../../context/MapContext';import timelineApiService from'../../services/timelineApi';import{useTranslatedText}from'../../utils/translationHelper';import'./Timeline.css';// Helper component to translate text items\nimport{Fragment as _Fragment,jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TranslatedText=_ref=>{let{text}=_ref;const{translatedText}=useTranslatedText(text||'');return/*#__PURE__*/_jsx(_Fragment,{children:translatedText});};const Timeline=_ref2=>{let{isVisible,onLocationSelect}=_ref2;const{t}=useTranslation();const{locations,selectLocation,selectedLocation}=useMapContext();const[selectedPeriod,setSelectedPeriod]=useState(null);const[isExpanded,setIsExpanded]=useState(false);const[timelinePeriods,setTimelinePeriods]=useState([]);const[isLoading,setIsLoading]=useState(false);const[error,setError]=useState(null);const[dataSource,setDataSource]=useState('none');const[apiHealth,setApiHealth]=useState(null);// Fetch timeline data from backend API\nconst fetchTimelineFromAPI=useCallback(async()=>{try{setIsLoading(true);setError(null);console.log('Timeline: Attempting to fetch from API...');// First check API health\ntry{const health=await timelineApiService.checkTimelineHealth();setApiHealth(health);console.log('Timeline API Health:',health);}catch(healthError){console.warn('Timeline API health check failed:',healthError.message);}// Fetch timeline data\nconst data=await timelineApiService.fetchTimelinePeriods();if(data.periods&&data.periods.length>0){setTimelinePeriods(data.periods);setDataSource('backend');console.log(`Timeline: Successfully loaded ${data.totalPeriods} periods from backend API`);console.log('Timeline data:',data);}else{throw new Error('No timeline periods received from API');}}catch(error){console.error('Timeline API Error:',error);setError(error.message);// Fallback to frontend processing\nconsole.log('Timeline: Falling back to frontend data processing');if(locations&&locations.length>0){const periods=processLocationsIntoTimeline(locations);setTimelinePeriods(periods);setDataSource('frontend-fallback');}else{setDataSource('no-data');}}finally{setIsLoading(false);}},[locations]);// Process locations into timeline periods (fallback method)\nconst processLocationsIntoTimeline=useCallback(locations=>{if(!locations||!Array.isArray(locations)){console.warn('Timeline: Invalid locations data for processing');return[];}const periodMap=new Map();locations.forEach(location=>{if(!location||!location.period)return;try{// Extract period information\nconst periodInfo=extractPeriodInfo(location.period);periodInfo.forEach(period=>{const key=period.label;if(!periodMap.has(key)){periodMap.set(key,{...period,locations:[]});}periodMap.get(key).locations.push(location);});}catch(err){console.warn(`Timeline: Error processing location ${location.name}:`,err);}});// Convert to array and sort by start year\nconst periodsArray=Array.from(periodMap.values());periodsArray.sort((a,b)=>a.startYear-b.startYear);console.log(`Timeline: Processed ${periodsArray.length} periods from ${locations.length} locations`);return periodsArray;},[]);const extractPeriodInfo=periodString=>{const periods=[];if(!periodString||typeof periodString!=='string'){return periods;}// Handle different period formats with more robust patterns\nconst patterns=[// \"1336 CE - 1646 CE\"\n{regex:/(\\d{1,4})\\s*CE\\s*-\\s*(\\d{1,4})\\s*CE/i,handler:match=>({startYear:parseInt(match[1]),endYear:parseInt(match[2]),label:`${match[1]} CE - ${match[2]} CE`,era:'CE'})},// \"13th century CE\"\n{regex:/(\\d{1,2})(?:st|nd|rd|th)\\s*century\\s*CE/i,handler:match=>{const century=parseInt(match[1]);const startYear=(century-1)*100+1;const endYear=century*100;return{startYear,endYear,label:`${century}${getOrdinalSuffix(century)} Century CE`,era:'CE'};}},// \"950 CE - 1050 CE\" (range without second CE)\n{regex:/(\\d{1,4})\\s*-\\s*(\\d{1,4})\\s*CE/i,handler:match=>({startYear:parseInt(match[1]),endYear:parseInt(match[2]),label:`${match[1]} - ${match[2]} CE`,era:'CE'})},// Single year \"1632 CE\"\n{regex:/(\\d{1,4})\\s*CE/i,handler:match=>({startYear:parseInt(match[1]),endYear:parseInt(match[1])+50,// Approximate 50-year span\nlabel:`${match[1]} CE`,era:'CE'})},// \"2nd century BCE\"\n{regex:/(\\d{1,2})(?:st|nd|rd|th)\\s*century\\s*BCE/i,handler:match=>{const century=parseInt(match[1]);return{startYear:-(century*100),endYear:-((century-1)*100+1),label:`${century}${getOrdinalSuffix(century)} Century BCE`,era:'BCE'};}},// Complex periods like \"3rd century BCE (with later additions)\"\n{regex:/(\\d{1,2})(?:st|nd|rd|th)\\s*century\\s*BCE.*$/i,handler:match=>{const century=parseInt(match[1]);return{startYear:-(century*100),endYear:-((century-1)*100+1),label:`${century}${getOrdinalSuffix(century)} Century BCE`,era:'BCE'};}}];for(const pattern of patterns){const match=periodString.match(pattern.regex);if(match){try{periods.push(pattern.handler(match));break;}catch(err){console.warn(`Error parsing period \"${periodString}\":`,err);continue;}}}// Fallback: create a general period\nif(periods.length===0){periods.push({startYear:1000,// Default\nendYear:2000,label:periodString.trim(),era:'Unknown'});}return periods;};// Helper function for ordinal suffixes\nconst getOrdinalSuffix=num=>{const remainder=num%10;const hundredRemainder=num%100;if(hundredRemainder>=11&&hundredRemainder<=13){return'th';}switch(remainder){case 1:return'st';case 2:return'nd';case 3:return'rd';default:return'th';}};// Main effect: Load timeline data when component becomes visible\nuseEffect(()=>{if(isVisible&&timelinePeriods.length===0){fetchTimelineFromAPI();}},[isVisible,fetchTimelineFromAPI,timelinePeriods.length]);// Fallback effect: Use local data if API fails and locations are available\nuseEffect(()=>{if(locations&&locations.length>0&&timelinePeriods.length===0&&!isLoading&&dataSource==='no-data'){console.log('Timeline: Using local locations data as final fallback');const periods=processLocationsIntoTimeline(locations);if(periods.length>0){setTimelinePeriods(periods);setDataSource('frontend');}}},[locations,timelinePeriods.length,isLoading,dataSource,processLocationsIntoTimeline]);const handlePeriodClick=period=>{if((selectedPeriod===null||selectedPeriod===void 0?void 0:selectedPeriod.label)===period.label){setSelectedPeriod(null);// Reset to modern view\nif(onLocationSelect){onLocationSelect(null,'modern');}}else{setSelectedPeriod(period);// Trigger historical visualization mode\nif(onLocationSelect){onLocationSelect(period.locations[0]||null,'historical',{period:period,era:period.era,timeframe:period.label});}}};const handleLocationClick=location=>{selectLocation(location);if(onLocationSelect){// Pass historical context when clicking from timeline\nonLocationSelect(location,'historical',{period:selectedPeriod,era:selectedPeriod===null||selectedPeriod===void 0?void 0:selectedPeriod.era,timeframe:selectedPeriod===null||selectedPeriod===void 0?void 0:selectedPeriod.label,dynasty:location.dynasty});}};const toggleExpanded=()=>{setIsExpanded(!isExpanded);};// Retry loading from API\nconst retryApiLoad=()=>{setError(null);setTimelinePeriods([]);setDataSource('none');fetchTimelineFromAPI();};const getEraColor=era=>{const colors={'CE':'#3f51b5','BCE':'#e91e63','Unknown':'#757575'};return colors[era]||colors['Unknown'];};const getDynastyColor=dynasty=>{if(!dynasty)return'#757575';const colors={'Mughal Empire':'#ff9800','Vijayanagara Empire':'#4caf50','Chandela Dynasty':'#9c27b0','Eastern Ganga Dynasty':'#f44336','Satavahana and Vakataka':'#00bcd4','Rashtrakuta Dynasty':'#795548','Delhi Sultanate':'#607d8b','Sikh Gurus':'#9c27b0','Portuguese Colonial':'#ff5722','Mauryan Empire':'#3f51b5'};// Find matching dynasty\nfor(const[key,color]of Object.entries(colors)){if(dynasty.includes(key)){return color;}}return'#757575';};if(!isVisible)return null;return/*#__PURE__*/_jsxs(\"div\",{className:`timeline-container ${isExpanded?'expanded':'collapsed'}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-header\",onClick:toggleExpanded,children:[/*#__PURE__*/_jsx(\"h3\",{children:t('timeline.title','Historical Timeline')}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-status\",children:[dataSource==='backend'&&/*#__PURE__*/_jsx(\"span\",{className:\"data-source-indicator api\",title:\"Data from backend API\",children:\"API\"}),dataSource==='frontend'&&/*#__PURE__*/_jsx(\"span\",{className:\"data-source-indicator local\",title:\"Data processed locally\",children:\"LOCAL\"}),dataSource==='frontend-fallback'&&/*#__PURE__*/_jsx(\"span\",{className:\"data-source-indicator fallback\",title:\"Fallback to local processing\",children:\"FALLBACK\"}),apiHealth&&/*#__PURE__*/_jsxs(\"span\",{className:\"api-health-indicator\",title:`${apiHealth.locationsWithPeriods}/${apiHealth.totalLocations} locations have period data`,children:[apiHealth.locationsWithPeriods,\"/\",apiHealth.totalLocations]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"expand-button\"})]}),isExpanded&&/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-content\",children:[isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:t('timeline.loading','Loading timeline data from server...')})]}),error&&!isLoading&&timelinePeriods.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-error\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[/*#__PURE__*/_jsx(\"p\",{children:t('timeline.error','Failed to load timeline data')}),/*#__PURE__*/_jsx(\"small\",{children:error})]}),/*#__PURE__*/_jsx(\"button\",{onClick:retryApiLoad,className:\"retry-button\",children:t('timeline.retry','Retry API Connection')})]}),!isLoading&&timelinePeriods.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"timeline-periods\",children:timelinePeriods.map((period,index)=>{var _period$locations,_period$locations2;return/*#__PURE__*/_jsxs(\"div\",{className:`timeline-period ${(selectedPeriod===null||selectedPeriod===void 0?void 0:selectedPeriod.label)===period.label?'active':''}`,onClick:()=>handlePeriodClick(period),children:[/*#__PURE__*/_jsx(\"div\",{className:\"period-marker\",style:{backgroundColor:getEraColor(period.era)}}),/*#__PURE__*/_jsxs(\"div\",{className:\"period-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"period-label\",children:period.label}),/*#__PURE__*/_jsxs(\"div\",{className:\"period-meta\",children:[((_period$locations=period.locations)===null||_period$locations===void 0?void 0:_period$locations.length)||0,\" location\",(((_period$locations2=period.locations)===null||_period$locations2===void 0?void 0:_period$locations2.length)||0)!==1?'s':'',period.era!=='Unknown'&&/*#__PURE__*/_jsxs(\"span\",{className:\"era-indicator\",children:[\" \\u2022 \",period.era]})]})]}),(selectedPeriod===null||selectedPeriod===void 0?void 0:selectedPeriod.label)===period.label&&period.locations&&/*#__PURE__*/_jsxs(\"div\",{className:\"period-locations\",children:[/*#__PURE__*/_jsx(\"h4\",{children:t('timeline.heritageSites','Heritage Sites from this Period')}),/*#__PURE__*/_jsx(\"ul\",{children:period.locations.map((location,locIndex)=>/*#__PURE__*/_jsxs(\"li\",{className:`location-item ${(selectedLocation===null||selectedLocation===void 0?void 0:selectedLocation.id)===location.id?'selected':''}`,onClick:e=>{e.stopPropagation();handleLocationClick(location);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"location-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"location-name\",children:/*#__PURE__*/_jsx(TranslatedText,{text:location.name})}),location.dynasty&&/*#__PURE__*/_jsx(\"div\",{className:\"location-dynasty\",children:/*#__PURE__*/_jsx(TranslatedText,{text:location.dynasty})}),location.category&&/*#__PURE__*/_jsx(\"div\",{className:\"location-category\",children:/*#__PURE__*/_jsx(TranslatedText,{text:location.category})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dynasty-indicator\",style:{backgroundColor:getDynastyColor(location.dynasty)},title:location.dynasty||'Unknown dynasty'})]},location.id||`${location.name}-${locIndex}`))})]})]},`${period.label}-${index}`);})}),(error||dataSource==='frontend-fallback')&&/*#__PURE__*/_jsx(\"div\",{className:\"timeline-info\",children:/*#__PURE__*/_jsxs(\"small\",{children:[dataSource==='frontend-fallback'&&'‚ö†Ô∏è Using fallback data processing',error&&!timelinePeriods.length&&'‚ùå Server connection failed']})})]}),!isLoading&&timelinePeriods.length===0&&!error&&/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-empty\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"timeline-empty-icon\",children:\"\\uD83D\\uDCC5\"}),/*#__PURE__*/_jsx(\"div\",{className:\"timeline-empty-text\",children:\"No timeline data available\"}),/*#__PURE__*/_jsx(\"button\",{onClick:retryApiLoad,className:\"retry-button\",children:\"Try Loading Again\"})]}),timelinePeriods.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"timeline-legend\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Era Legend\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"legend-items\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-color\",style:{backgroundColor:'#3f51b5'}}),/*#__PURE__*/_jsx(\"span\",{children:\"Common Era (CE)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-color\",style:{backgroundColor:'#e91e63'}}),/*#__PURE__*/_jsx(\"span\",{children:\"Before Common Era (BCE)\"})]}),timelinePeriods.some(p=>p.era==='Unknown')&&/*#__PURE__*/_jsxs(\"div\",{className:\"legend-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"legend-color\",style:{backgroundColor:'#757575'}}),/*#__PURE__*/_jsx(\"span\",{children:\"Unknown Period\"})]})]})]})]})]});};export default Timeline;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useTranslation","useMapContext","timelineApiService","useTranslatedText","Fragment","_Fragment","jsx","_jsx","jsxs","_jsxs","TranslatedText","_ref","text","translatedText","children","Timeline","_ref2","isVisible","onLocationSelect","t","locations","selectLocation","selectedLocation","selectedPeriod","setSelectedPeriod","isExpanded","setIsExpanded","timelinePeriods","setTimelinePeriods","isLoading","setIsLoading","error","setError","dataSource","setDataSource","apiHealth","setApiHealth","fetchTimelineFromAPI","console","log","health","checkTimelineHealth","healthError","warn","message","data","fetchTimelinePeriods","periods","length","totalPeriods","Error","processLocationsIntoTimeline","Array","isArray","periodMap","Map","forEach","location","period","periodInfo","extractPeriodInfo","key","label","has","set","get","push","err","name","periodsArray","from","values","sort","a","b","startYear","periodString","patterns","regex","handler","match","parseInt","endYear","era","century","getOrdinalSuffix","pattern","trim","num","remainder","hundredRemainder","handlePeriodClick","timeframe","handleLocationClick","dynasty","toggleExpanded","retryApiLoad","getEraColor","colors","getDynastyColor","color","Object","entries","includes","className","onClick","title","locationsWithPeriods","totalLocations","map","index","_period$locations","_period$locations2","style","backgroundColor","locIndex","id","e","stopPropagation","category","some","p"],"sources":["D:/MY projects/CupeKG/cupe-kg-frontend/src/components/Timeline/Timeline.jsx"],"sourcesContent":["// cupe-kg-frontend/src/components/Timeline/Timeline.jsx\r\n// FINAL VERSION with Complete API Integration\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useMapContext } from '../../context/MapContext';\r\nimport timelineApiService from '../../services/timelineApi';\r\nimport { useTranslatedText } from '../../utils/translationHelper';\r\nimport './Timeline.css';\r\n\r\n// Helper component to translate text items\r\nconst TranslatedText = ({ text }) => {\r\n  const { translatedText } = useTranslatedText(text || '');\r\n  return <>{translatedText}</>;\r\n};\r\n\r\nconst Timeline = ({ isVisible, onLocationSelect }) => {\r\n  const { t } = useTranslation();\r\n  const { locations, selectLocation, selectedLocation } = useMapContext();\r\n  const [selectedPeriod, setSelectedPeriod] = useState(null);\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n  const [timelinePeriods, setTimelinePeriods] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [dataSource, setDataSource] = useState('none');\r\n  const [apiHealth, setApiHealth] = useState(null);\r\n\r\n  // Fetch timeline data from backend API\r\n  const fetchTimelineFromAPI = useCallback(async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      setError(null);\r\n      \r\n      console.log('Timeline: Attempting to fetch from API...');\r\n      \r\n      // First check API health\r\n      try {\r\n        const health = await timelineApiService.checkTimelineHealth();\r\n        setApiHealth(health);\r\n        console.log('Timeline API Health:', health);\r\n      } catch (healthError) {\r\n        console.warn('Timeline API health check failed:', healthError.message);\r\n      }\r\n      \r\n      // Fetch timeline data\r\n      const data = await timelineApiService.fetchTimelinePeriods();\r\n      \r\n      if (data.periods && data.periods.length > 0) {\r\n        setTimelinePeriods(data.periods);\r\n        setDataSource('backend');\r\n        console.log(`Timeline: Successfully loaded ${data.totalPeriods} periods from backend API`);\r\n        console.log('Timeline data:', data);\r\n      } else {\r\n        throw new Error('No timeline periods received from API');\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('Timeline API Error:', error);\r\n      setError(error.message);\r\n      \r\n      // Fallback to frontend processing\r\n      console.log('Timeline: Falling back to frontend data processing');\r\n      if (locations && locations.length > 0) {\r\n        const periods = processLocationsIntoTimeline(locations);\r\n        setTimelinePeriods(periods);\r\n        setDataSource('frontend-fallback');\r\n      } else {\r\n        setDataSource('no-data');\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [locations]);\r\n\r\n  // Process locations into timeline periods (fallback method)\r\n  const processLocationsIntoTimeline = useCallback((locations) => {\r\n    if (!locations || !Array.isArray(locations)) {\r\n      console.warn('Timeline: Invalid locations data for processing');\r\n      return [];\r\n    }\r\n\r\n    const periodMap = new Map();\r\n    \r\n    locations.forEach(location => {\r\n      if (!location || !location.period) return;\r\n      \r\n      try {\r\n        // Extract period information\r\n        const periodInfo = extractPeriodInfo(location.period);\r\n        \r\n        periodInfo.forEach(period => {\r\n          const key = period.label;\r\n          if (!periodMap.has(key)) {\r\n            periodMap.set(key, {\r\n              ...period,\r\n              locations: []\r\n            });\r\n          }\r\n          periodMap.get(key).locations.push(location);\r\n        });\r\n      } catch (err) {\r\n        console.warn(`Timeline: Error processing location ${location.name}:`, err);\r\n      }\r\n    });\r\n    \r\n    // Convert to array and sort by start year\r\n    const periodsArray = Array.from(periodMap.values());\r\n    periodsArray.sort((a, b) => a.startYear - b.startYear);\r\n    \r\n    console.log(`Timeline: Processed ${periodsArray.length} periods from ${locations.length} locations`);\r\n    return periodsArray;\r\n  }, []);\r\n\r\n  const extractPeriodInfo = (periodString) => {\r\n    const periods = [];\r\n    \r\n    if (!periodString || typeof periodString !== 'string') {\r\n      return periods;\r\n    }\r\n    \r\n    // Handle different period formats with more robust patterns\r\n    const patterns = [\r\n      // \"1336 CE - 1646 CE\"\r\n      {\r\n        regex: /(\\d{1,4})\\s*CE\\s*-\\s*(\\d{1,4})\\s*CE/i,\r\n        handler: (match) => ({\r\n          startYear: parseInt(match[1]),\r\n          endYear: parseInt(match[2]),\r\n          label: `${match[1]} CE - ${match[2]} CE`,\r\n          era: 'CE'\r\n        })\r\n      },\r\n      // \"13th century CE\"\r\n      {\r\n        regex: /(\\d{1,2})(?:st|nd|rd|th)\\s*century\\s*CE/i,\r\n        handler: (match) => {\r\n          const century = parseInt(match[1]);\r\n          const startYear = (century - 1) * 100 + 1;\r\n          const endYear = century * 100;\r\n          return {\r\n            startYear,\r\n            endYear,\r\n            label: `${century}${getOrdinalSuffix(century)} Century CE`,\r\n            era: 'CE'\r\n          };\r\n        }\r\n      },\r\n      // \"950 CE - 1050 CE\" (range without second CE)\r\n      {\r\n        regex: /(\\d{1,4})\\s*-\\s*(\\d{1,4})\\s*CE/i,\r\n        handler: (match) => ({\r\n          startYear: parseInt(match[1]),\r\n          endYear: parseInt(match[2]),\r\n          label: `${match[1]} - ${match[2]} CE`,\r\n          era: 'CE'\r\n        })\r\n      },\r\n      // Single year \"1632 CE\"\r\n      {\r\n        regex: /(\\d{1,4})\\s*CE/i,\r\n        handler: (match) => ({\r\n          startYear: parseInt(match[1]),\r\n          endYear: parseInt(match[1]) + 50, // Approximate 50-year span\r\n          label: `${match[1]} CE`,\r\n          era: 'CE'\r\n        })\r\n      },\r\n      // \"2nd century BCE\"\r\n      {\r\n        regex: /(\\d{1,2})(?:st|nd|rd|th)\\s*century\\s*BCE/i,\r\n        handler: (match) => {\r\n          const century = parseInt(match[1]);\r\n          return {\r\n            startYear: -(century * 100),\r\n            endYear: -((century - 1) * 100 + 1),\r\n            label: `${century}${getOrdinalSuffix(century)} Century BCE`,\r\n            era: 'BCE'\r\n          };\r\n        }\r\n      },\r\n      // Complex periods like \"3rd century BCE (with later additions)\"\r\n      {\r\n        regex: /(\\d{1,2})(?:st|nd|rd|th)\\s*century\\s*BCE.*$/i,\r\n        handler: (match) => {\r\n          const century = parseInt(match[1]);\r\n          return {\r\n            startYear: -(century * 100),\r\n            endYear: -((century - 1) * 100 + 1),\r\n            label: `${century}${getOrdinalSuffix(century)} Century BCE`,\r\n            era: 'BCE'\r\n          };\r\n        }\r\n      }\r\n    ];\r\n    \r\n    for (const pattern of patterns) {\r\n      const match = periodString.match(pattern.regex);\r\n      if (match) {\r\n        try {\r\n          periods.push(pattern.handler(match));\r\n          break;\r\n        } catch (err) {\r\n          console.warn(`Error parsing period \"${periodString}\":`, err);\r\n          continue;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Fallback: create a general period\r\n    if (periods.length === 0) {\r\n      periods.push({\r\n        startYear: 1000, // Default\r\n        endYear: 2000,\r\n        label: periodString.trim(),\r\n        era: 'Unknown'\r\n      });\r\n    }\r\n    \r\n    return periods;\r\n  };\r\n\r\n  // Helper function for ordinal suffixes\r\n  const getOrdinalSuffix = (num) => {\r\n    const remainder = num % 10;\r\n    const hundredRemainder = num % 100;\r\n    \r\n    if (hundredRemainder >= 11 && hundredRemainder <= 13) {\r\n      return 'th';\r\n    }\r\n    \r\n    switch (remainder) {\r\n      case 1: return 'st';\r\n      case 2: return 'nd';\r\n      case 3: return 'rd';\r\n      default: return 'th';\r\n    }\r\n  };\r\n\r\n  // Main effect: Load timeline data when component becomes visible\r\n  useEffect(() => {\r\n    if (isVisible && timelinePeriods.length === 0) {\r\n      fetchTimelineFromAPI();\r\n    }\r\n  }, [isVisible, fetchTimelineFromAPI, timelinePeriods.length]);\r\n\r\n  // Fallback effect: Use local data if API fails and locations are available\r\n  useEffect(() => {\r\n    if (locations && locations.length > 0 && timelinePeriods.length === 0 && !isLoading && dataSource === 'no-data') {\r\n      console.log('Timeline: Using local locations data as final fallback');\r\n      const periods = processLocationsIntoTimeline(locations);\r\n      if (periods.length > 0) {\r\n        setTimelinePeriods(periods);\r\n        setDataSource('frontend');\r\n      }\r\n    }\r\n  }, [locations, timelinePeriods.length, isLoading, dataSource, processLocationsIntoTimeline]);\r\n\r\n  const handlePeriodClick = (period) => {\r\n    if (selectedPeriod?.label === period.label) {\r\n      setSelectedPeriod(null);\r\n      // Reset to modern view\r\n      if (onLocationSelect) {\r\n        onLocationSelect(null, 'modern');\r\n      }\r\n    } else {\r\n      setSelectedPeriod(period);\r\n      // Trigger historical visualization mode\r\n      if (onLocationSelect) {\r\n        onLocationSelect(period.locations[0] || null, 'historical', {\r\n          period: period,\r\n          era: period.era,\r\n          timeframe: period.label\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleLocationClick = (location) => {\r\n    selectLocation(location);\r\n    if (onLocationSelect) {\r\n      // Pass historical context when clicking from timeline\r\n      onLocationSelect(location, 'historical', {\r\n        period: selectedPeriod,\r\n        era: selectedPeriod?.era,\r\n        timeframe: selectedPeriod?.label,\r\n        dynasty: location.dynasty\r\n      });\r\n    }\r\n  };\r\n\r\n  const toggleExpanded = () => {\r\n    setIsExpanded(!isExpanded);\r\n  };\r\n\r\n  // Retry loading from API\r\n  const retryApiLoad = () => {\r\n    setError(null);\r\n    setTimelinePeriods([]);\r\n    setDataSource('none');\r\n    fetchTimelineFromAPI();\r\n  };\r\n\r\n  const getEraColor = (era) => {\r\n    const colors = {\r\n      'CE': '#3f51b5',\r\n      'BCE': '#e91e63',\r\n      'Unknown': '#757575'\r\n    };\r\n    return colors[era] || colors['Unknown'];\r\n  };\r\n\r\n  const getDynastyColor = (dynasty) => {\r\n    if (!dynasty) return '#757575';\r\n    \r\n    const colors = {\r\n      'Mughal Empire': '#ff9800',\r\n      'Vijayanagara Empire': '#4caf50',\r\n      'Chandela Dynasty': '#9c27b0',\r\n      'Eastern Ganga Dynasty': '#f44336',\r\n      'Satavahana and Vakataka': '#00bcd4',\r\n      'Rashtrakuta Dynasty': '#795548',\r\n      'Delhi Sultanate': '#607d8b',\r\n      'Sikh Gurus': '#9c27b0',\r\n      'Portuguese Colonial': '#ff5722',\r\n      'Mauryan Empire': '#3f51b5'\r\n    };\r\n    \r\n    // Find matching dynasty\r\n    for (const [key, color] of Object.entries(colors)) {\r\n      if (dynasty.includes(key)) {\r\n        return color;\r\n      }\r\n    }\r\n    return '#757575';\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  return (\r\n    <div className={`timeline-container ${isExpanded ? 'expanded' : 'collapsed'}`}>\r\n      <div className=\"timeline-header\" onClick={toggleExpanded}>\r\n        <h3>{t('timeline.title', 'Historical Timeline')}</h3>\r\n        <div className=\"timeline-status\">\r\n          {dataSource === 'backend' && <span className=\"data-source-indicator api\" title=\"Data from backend API\">API</span>}\r\n          {dataSource === 'frontend' && <span className=\"data-source-indicator local\" title=\"Data processed locally\">LOCAL</span>}\r\n          {dataSource === 'frontend-fallback' && <span className=\"data-source-indicator fallback\" title=\"Fallback to local processing\">FALLBACK</span>}\r\n          {apiHealth && (\r\n            <span className=\"api-health-indicator\" title={`${apiHealth.locationsWithPeriods}/${apiHealth.totalLocations} locations have period data`}>\r\n              {apiHealth.locationsWithPeriods}/{apiHealth.totalLocations}\r\n            </span>\r\n          )}\r\n        </div>\r\n        <button className=\"expand-button\" />\r\n      </div>\r\n      \r\n      {isExpanded && (\r\n        <div className=\"timeline-content\">\r\n          {/* Loading State */}\r\n          {isLoading && (\r\n            <div className=\"timeline-loading\">\r\n              <div className=\"loading-spinner\"></div>\r\n              <p>{t('timeline.loading', 'Loading timeline data from server...')}</p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Error State with Retry */}\r\n          {error && !isLoading && timelinePeriods.length === 0 && (\r\n            <div className=\"timeline-error\">\r\n              <div className=\"error-message\">\r\n                <p>{t('timeline.error', 'Failed to load timeline data')}</p>\r\n                <small>{error}</small>\r\n              </div>\r\n              <button onClick={retryApiLoad} className=\"retry-button\">\r\n                {t('timeline.retry', 'Retry API Connection')}\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Timeline Periods */}\r\n          {!isLoading && timelinePeriods.length > 0 && (\r\n            <>\r\n              <div className=\"timeline-periods\">\r\n                {timelinePeriods.map((period, index) => (\r\n                  <div \r\n                    key={`${period.label}-${index}`}\r\n                    className={`timeline-period ${selectedPeriod?.label === period.label ? 'active' : ''}`}\r\n                    onClick={() => handlePeriodClick(period)}\r\n                  >\r\n                    <div \r\n                      className=\"period-marker\"\r\n                      style={{ backgroundColor: getEraColor(period.era) }}\r\n                    />\r\n                    \r\n                    <div className=\"period-info\">\r\n                      <div className=\"period-label\">\r\n                        {period.label}\r\n                      </div>\r\n                      <div className=\"period-meta\">\r\n                        {period.locations?.length || 0} location{(period.locations?.length || 0) !== 1 ? 's' : ''}\r\n                        {period.era !== 'Unknown' && (\r\n                          <span className=\"era-indicator\"> ‚Ä¢ {period.era}</span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {selectedPeriod?.label === period.label && period.locations && (\r\n                      <div className=\"period-locations\">\r\n                        <h4>{t('timeline.heritageSites', 'Heritage Sites from this Period')}</h4>\r\n                        <ul>\r\n                          {period.locations.map((location, locIndex) => (\r\n                            <li\r\n                              key={location.id || `${location.name}-${locIndex}`}\r\n                              className={`location-item ${selectedLocation?.id === location.id ? 'selected' : ''}`}\r\n                              onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                handleLocationClick(location);\r\n                              }}\r\n                            >\r\n                              <div className=\"location-info\">\r\n                                <div className=\"location-name\">\r\n                                  <TranslatedText text={location.name} />\r\n                                </div>\r\n                                {location.dynasty && (\r\n                                  <div className=\"location-dynasty\">\r\n                                    <TranslatedText text={location.dynasty} />\r\n                                  </div>\r\n                                )}\r\n                                {location.category && (\r\n                                  <div className=\"location-category\">\r\n                                    <TranslatedText text={location.category} />\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                              <div \r\n                                className=\"dynasty-indicator\"\r\n                                style={{ backgroundColor: getDynastyColor(location.dynasty) }}\r\n                                title={location.dynasty || 'Unknown dynasty'}\r\n                              />\r\n                            </li>\r\n                          ))}\r\n                        </ul>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              \r\n              {/* Data source info */}\r\n              {(error || dataSource === 'frontend-fallback') && (\r\n                <div className=\"timeline-info\">\r\n                  <small>\r\n                    {dataSource === 'frontend-fallback' && '‚ö†Ô∏è Using fallback data processing'}\r\n                    {error && !timelinePeriods.length && '‚ùå Server connection failed'}\r\n                  </small>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n\r\n          {/* Empty State */}\r\n          {!isLoading && timelinePeriods.length === 0 && !error && (\r\n            <div className=\"timeline-empty\">\r\n              <div className=\"timeline-empty-icon\">üìÖ</div>\r\n              <div className=\"timeline-empty-text\">\r\n                No timeline data available\r\n              </div>\r\n              <button onClick={retryApiLoad} className=\"retry-button\">\r\n                Try Loading Again\r\n              </button>\r\n            </div>\r\n          )}\r\n          \r\n          {/* Legend */}\r\n          {timelinePeriods.length > 0 && (\r\n            <div className=\"timeline-legend\">\r\n              <h4>Era Legend</h4>\r\n              <div className=\"legend-items\">\r\n                <div className=\"legend-item\">\r\n                  <div className=\"legend-color\" style={{ backgroundColor: '#3f51b5' }}></div>\r\n                  <span>Common Era (CE)</span>\r\n                </div>\r\n                <div className=\"legend-item\">\r\n                  <div className=\"legend-color\" style={{ backgroundColor: '#e91e63' }}></div>\r\n                  <span>Before Common Era (BCE)</span>\r\n                </div>\r\n                {timelinePeriods.some(p => p.era === 'Unknown') && (\r\n                  <div className=\"legend-item\">\r\n                    <div className=\"legend-color\" style={{ backgroundColor: '#757575' }}></div>\r\n                    <span>Unknown Period</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Timeline;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}